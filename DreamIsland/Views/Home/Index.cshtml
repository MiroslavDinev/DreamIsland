@model List<IslandListingViewModel>

@{
    ViewBag.Title = "Dream Island - Welcome";

    var firstIsland = Model.Any() ? Model[0] : null;
    var secondIsland = Model.Count > 1 ? Model[1] : null;
    var thirdIsland = Model.Count > 2 ? Model[2] : null;
}

@if (!Model.Any())
{
    <div class="jumbotron">
        <h1 class="display-4">Welcome to Dream Island!</h1>
        <p class="lead">Currently we do not have any available islands for sale</p>
        <hr class="my-4">
        <p>You can contact us or check other listings</p>
        <p class="lead">
            <a asp-controller="Cars" asp-action="All" class="btn btn-primary btn-lg">Car Offers</a>
        </p>
        <p class="lead">
            <a asp-controller="Celebrities" asp-action="All" class="btn btn-primary btn-lg">Celebrity Offers</a>
        </p>
        <p class="lead">
            <a asp-controller="Collectibles" asp-action="All" class="btn btn-primary btn-lg">Collectible Offers</a>
        </p>
    </div>
}

else
{
    <div id="carouselExampleIndicators" class="carousel slide mb-5" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img class="d-block w-100" src="@firstIsland.ImageUrl" alt="@firstIsland.Name">
                <div class="carousel-caption d-none d-md-block">
                    <h5><a class="btn btn-primary" asp-controller="Islands" asp-action="Details" asp-route-id="@firstIsland.Id">@firstIsland.Name</a></h5>
                    @{

                        var firstIslandPrice = "Price upon request";

                        if (firstIsland.Price.HasValue)
                        {
                            firstIslandPrice = firstIsland.Price + " USD";
                        }
                    }
                    <p>@firstIslandPrice</p>
                </div>
            </div>
            @if (secondIsland != null)
            {
                <div class="carousel-item">
                    <img class="d-block w-100" src="@secondIsland.ImageUrl" alt="@secondIsland.Name">
                    <div class="carousel-caption d-none d-md-block">
                        <h5><a class="btn btn-primary" asp-controller="Islands" asp-action="Details" asp-route-id="@secondIsland.Id">@secondIsland.Name</a></h5>
                        @{

                            var secondIslandPrice = "Price upon request";

                            if (secondIsland.Price.HasValue)
                            {
                                secondIslandPrice = secondIsland.Price + " USD";
                            }
                        }
                        <p>@secondIslandPrice</p>
                    </div>
                </div>
            }
            @if (thirdIsland != null)
            {
                <div class="carousel-item">
                    <img class="d-block w-100" src="@thirdIsland.ImageUrl" alt="@thirdIsland.Name">
                    <div class="carousel-caption d-none d-md-block">
                        <h5><a class="btn btn-primary" asp-controller="Islands" asp-action="Details" asp-route-id="@thirdIsland.Id">@thirdIsland.Name</a></h5>
                        @{

                            var thirdIslandPrice = "Price upon request";

                            if (thirdIsland.Price.HasValue)
                            {
                                thirdIslandPrice = thirdIsland.Price + " USD";
                            }
                        }
                        <p>@thirdIslandPrice</p>
                    </div>
                </div>
            }
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
}

<div class="row">
    <div class="col-12 text-center">
        <button class="btn btn-primary" id="statistics-button">Our Stats</button>
    </div>
</div>

<div class="jumbotron jumbotron-fluid d-none" id="statistics">
    <div class="container">
        <div class="row">
            <h2 class="col-md-3 text-center" id="total-islands"></h2>
            <h2 class="col-md-3 text-center" id="total-cars"></h2>
            <h2 class="col-md-3 text-center" id="total-celebrities"></h2>
            <h2 class="col-md-3 text-center" id="total-collectibles"></h2>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        $('#statistics-button').on('click', ev => {
            $.get('/api/statistics', (data) => {
                $('#total-islands').text(data.totalIslands + " Islands");
                $('#total-cars').text(data.totalCars + " Cars");
                $('#total-celebrities').text(data.totalCelebrities + " Celebrities");
                $('#total-collectibles').text(data.totalCollectibles + " Collectibles");

                $('#statistics').removeClass('d-none');
                $('#statistics-button').hide();
            });
        });
    </script>
}
